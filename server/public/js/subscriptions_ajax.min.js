!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=1)}([function(e,t,n){"use strict";function r(e,t=5e3){setTimeout(()=>{e.hidden=!0},t)}function o(e,t,n,r,o=null){e.classList.remove(t),e.classList.add(n),o&&setTimeout(()=>{e.classList.remove(n),e.classList.add(r)},o)}function l(e,t="",n=!1){let r=document.createElement("i");r.setAttribute("class","fa fa-spinner fa-spin spinner"+t),n&&e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r)}function s(e,t=""){try{let n=e.getElementsByClassName("fa fa-spinner fa-spin spinner"+t);for(let t=0;t<n.length;t++)e.removeChild(n[t])}catch(e){console.log("No spinner to remove"),console.log(e)}}function i(e,t=5e3,n="rgba(0, 0, 0, 0.2"){$(".popover").css("border-color",n),e.popover("show"),setTimeout(e=>{e.popover("dispose")},t,e)}function a(e,t=5e3){e.classList.add("errorBorder"),setTimeout(e=>{e.classList.remove("errorBorder")},t,e)}function d(e){var t=[];return e.forEach(e=>{t.push({element:e,scrollY:e.scrollTop,scrollX:e.scrollLeft})}),t}function c(e){document.getElementsByTagName("html")[0].style.scrollBehavior="auto",e.forEach(e=>{e.element.scrollTo(e.scrollX,e.scrollY)}),document.getElementsByTagName("html")[0].style.scrollBehavior="smooth"}function u(e,t){for(let n=0;n<e.length;n++)t.forEach(t=>{e[n].classList.add(t)})}function m(e,t){for(let n=0;n<e.length;n++)t.forEach(t=>{e[n].classList.remove(t)})}function p(e){for(let t=0;t<e.length;t++)e[t].style.display="none"}function y(e){for(let t=0;t<e.length;t++)e[t].innerText=""}function b(e){e.getContext("2d").clearRect(0,0,e.width,e.height),e.classList.remove("light-border"),e.height="1rem"}function f(){let e=document.getElementsByTagName("html")[0],t=document.getElementsByTagName("body")[0];if(e.clientHeight+100<t.clientHeight){document.getElementsByClassName("usa-footer__return-to-top")[0].style.display="block"}}function v(){var e=[{name:"Windows Phone",value:"Windows Phone",version:"OS"},{name:"Windows",value:"Win",version:"NT"},{name:"iPhone",value:"iPhone",version:"OS"},{name:"iPad",value:"iPad",version:"OS"},{name:"Kindle",value:"Silk",version:"Silk"},{name:"Android",value:"Android",version:"Android"},{name:"PlayBook",value:"PlayBook",version:"OS"},{name:"BlackBerry",value:"BlackBerry",version:"/"},{name:"Macintosh",value:"Mac",version:"OS X"},{name:"Linux",value:"Linux",version:"rv"},{name:"Palm",value:"Palm",version:"PalmOS"}],t=[{name:"Chrome",value:"Chrome",version:"Chrome"},{name:"Firefox",value:"Firefox",version:"Firefox"},{name:"Safari",value:"Safari",version:"Version"},{name:"Internet Explorer",value:"MSIE",version:"MSIE"},{name:"Opera",value:"Opera",version:"Opera"},{name:"BlackBerry",value:"CLDC",version:"CLDC"},{name:"Mozilla",value:"Mozilla",version:"Mozilla"}],n=[navigator.platform,navigator.userAgent,navigator.appVersion,navigator.vendor,window.opera].join(" ");e=r(n,e);function r(e,t){var n,r,o,l=0,s=0;for(l=0;l<t.length;l+=1)if(new RegExp(t[l].value,"i").test(e)){if(n=new RegExp(t[l].version+"[- /:;]([d._]+)","i"),o="",(r=e.match(n))&&r[1]&&(r=r[1]),r)for(r=r.split(/[._]+/),s=0;s<r.length;s+=1)o+=0===s?r[s]+".":r[s];else o="0";return{name:t[l].name,version:parseFloat(o)}}return{name:"unknown",version:0}}"Chrome"!==(t=r(n,t)).name&&"Firefox"!==t.name&&"Safari"!==t.name||document.getElementById("browserWarning").setAttribute("style","display: none"),navigator.userAgent.match("Edge")&&document.getElementById("browserWarning").setAttribute("style","display: none")}function g(e){for(let t=0;t<e.length;t++)e[t].disabled=!0}function E(e){for(let t=0;t<e.length;t++)e[t].disabled=!1}function w(e){for(var t=e.elements,n=0;n<t.length;n++)t[n].disabled=!0}function h(e){for(var t=e.elements,n=0;n<t.length;n++)t[n].disabled=!1}function S(e){var t=document.createElement("a"),n=new Uint8Array(e.file.data),r=new Blob([n]),o=window.URL.createObjectURL(r);t.href=o,t.download=e.filename,document.body.appendChild(t),t.click(),setTimeout((function(){document.body.removeChild(t),window.URL.revokeObjectURL(o)}),0)}function B(e){let t=e.getElementsByTagName("tbody");for(;t.length>0;)t[0].remove()}function I(e){let t=e.getElementsByTagName("tbody")[0];for(;t.childNodes.length>0;)t.childNodes[0].remove()}function C(e,t){t.forEach(t=>{e.appendChild(t.element),t.nextElement&&e.appendChild(t.nextElement)})}function T(e,t){let n=e.getElementsByTagName("tbody")[0];t.forEach(e=>{n.appendChild(e.element),e.nextElement&&n.appendChild(e.nextElement)})}function L(e){for(let t=0;t<e.length;t++)e[t].classList.remove("sort","sortedUp","sortedDown"),e[t].classList.add("sort")}function A(e,t=!0){let n,r,o;for(let l=1;l<e.length;l++){if(r=e[l].value,o=l,t)for(;o>0&&r<e[o-1].value;)o--;else for(;o>0&&r>e[o-1].value;)o--;n=e[l],e.splice(l,1),e.splice(o,0,n)}}function x(){let e=document.getElementById("iconCache");["downloadSubscription","downloadSubscriptionError","downloadSubscriptionSuccess","downloadSubscriptionSecondary","downloadSubscriptionLg","downloadSubscriptionErrorLg","downloadSubscriptionSuccessLg","downloadSubscriptionSecondaryLg","email","emailSuccess","emailError","preview","previewSecondary","trashCan","trashCanSecondary"].forEach(t=>{let n=document.createElement("i");n.classList.add(t),e.appendChild(n)})}n.r(t),n.d(t,"hiddenTimer",(function(){return r})),n.d(t,"classTimer",(function(){return o})),n.d(t,"showSpinner",(function(){return l})),n.d(t,"removeSpinner",(function(){return s})),n.d(t,"showPopover",(function(){return i})),n.d(t,"setErrorBorder",(function(){return a})),n.d(t,"scrollSave",(function(){return d})),n.d(t,"scrollRestore",(function(){return c})),n.d(t,"addClasses",(function(){return u})),n.d(t,"removeClasses",(function(){return m})),n.d(t,"hideElements",(function(){return p})),n.d(t,"clearInnerText",(function(){return y})),n.d(t,"clearCanvas",(function(){return b})),n.d(t,"displayReturnToTop",(function(){return f})),n.d(t,"displayBrowserWarning",(function(){return v})),n.d(t,"disableElements",(function(){return g})),n.d(t,"enableElements",(function(){return E})),n.d(t,"disableForm",(function(){return w})),n.d(t,"enableForm",(function(){return h})),n.d(t,"clientDownloadFile",(function(){return S})),n.d(t,"clearTableGroups",(function(){return B})),n.d(t,"clearTableRows",(function(){return I})),n.d(t,"displayTableGroups",(function(){return C})),n.d(t,"displayTableRows",(function(){return T})),n.d(t,"removeSortClasses",(function(){return L})),n.d(t,"insertionSort",(function(){return A})),n.d(t,"downloadIcons",(function(){return x})),document.addEventListener("DOMContentLoaded",()=>{f(),v()})},function(e,t,n){"use strict";n.r(t),n.d(t,"templatePreview",(function(){return l})),n.d(t,"templateDownload",(function(){return s})),n.d(t,"submitNewSubscription",(function(){return i})),n.d(t,"addNewSubscriptionPrevTemplate",(function(){return a})),n.d(t,"addNewSubscriptionWithTemplateFile",(function(){return d})),n.d(t,"fetchUserTemplates",(function(){return c})),n.d(t,"fetchUserSubscriptionList",(function(){return u})),n.d(t,"deleteSubscription",(function(){return m})),n.d(t,"downloadSubscription",(function(){return p})),n.d(t,"fireSubscriptionEmail",(function(){return y}));var r=n(0),o=n(2);function l(e,t=null){var n=document.getElementById("previewTemplateLabel"),l=document.getElementById("canvasSpinnerContainer");let s;n.innerText="Loading ",r.showSpinner(l,"-lg"),r.showSpinner(n),$("#previewTemplateModal").modal({keyboard:!0,focus:!0}),s=e?fetch("/preview_template?templateId="+e):fetch("/preview_subscription?tok="+t),s.then(e=>{if(200==e.status)return e.json();throw new Error("Error retrieving file")}).then(l=>{if(!l.success)throw new Error("Error retrieving file");r.removeSpinner(n),n.innerText=l.filename,Object(o.addDownloadFromPreview)(n,e,t,l.post,l.country);let s=new Uint8Array(l.file.data);return Object(o.pdfToCanvas)(s)}).then(()=>{document.getElementById("previewCanvas").classList.add("light-border")}).catch(e=>{console.log(e),n.innerText=e}).finally(()=>{r.removeSpinner(l,"-lg"),l.innerText=""})}function s(e){var t=document.getElementById("downloadTemplateSpan");return t.classList.remove("downloadError","downloadSuccess"),r.showSpinner(t," md",!0),fetch("/download_template?templateId="+e).then(e=>{if(200==e.status)return e.json();throw new Error("Error retrieving file")}).then(e=>{if(!e.success)throw new Error("Error retrieving file");r.clientDownloadFile(e),t.classList.add("downloadSuccess")}).catch(e=>{throw console.log(e),t.classList.add("downloadError"),new Error("Error retrieving file")}).finally(()=>{r.removeSpinner(t," md")})}async function i(){let e=document.getElementById("uploadTemplate"),t=document.getElementById("templateSelect"),n=document.getElementById("postSelect"),l=n[n.selectedIndex].getAttribute("data-COLARatesId");r.showSpinner(document.getElementById("subscriptionsContainerSpinner")),document.getElementById("tableSpinner").display="inline-block";try{if(e.value)var s=!0,i=await d(l,e);else if(0!=t.selectedIndex)i=await a(l,t);if(!i.success)throw i.error?new Error(i.error):i;n.selectedIndex=0,t.selectedIndex=0,e.value="",Object(o.newSubscriptionSuccess)(l);c();addSubscriptionToTable(i)}catch(e){console.log(e),r.hideElements(document.getElementsByClassName("alert")),i.success?document.getElementById("errorContainer").style.display="block":(document.getElementById("warningContainer").style.display="block",s?(document.getElementById("uploadTemplateErrorMsg").innerText=i.errorMessage,document.getElementById("uploadTemplateErrorMsg").style.display="block"):(document.getElementById("previousTemplateErrorMsg").innerText=i.errorMessage,document.getElementById("previousTemplateErrorMsg").style.display="block"))}finally{document.getElementById("tableSpinner").display="none",r.removeSpinner(document.getElementById("subscriptionsContainerSpinner")),Object(o.checkEmptySubscriptions)()}}async function a(e,t){try{let r={postId:e,templateId:t[t.selectedIndex].getAttribute("data-templateId")};var n=await fetch("/add_new_subscription_with_prev_template",{method:"POST",headers:{"Content-Type":"application/JSON"},body:JSON.stringify(r)});return await n.json()}catch(e){return console.log(e),e}}async function d(e,t){if(!(window.File&&window.FileReader&&window.FileList&&window.Blob))return console.log("File API not supported by broser"),void($("addSubscriptionMessageDiv").innerText="Incompatible browser");try{let r=new FormData;r.append("upload",t.files[0]),r.append("postId",e);var n=await fetch("/add_new_subscription_with_template_file",{method:"POST",body:r});return await n.json()}catch(e){return console.log(e),e}}async function c(){try{var e=document.getElementById("templateSelect");clearDropdown(e),e.innerHTML='<option>Loading...<i class="fa fa-spinner spinner"></i></option>';let t=await fetch("/get_user_template_list"),n=await t.json();clearDropdown(e),populateTemplateDropdown(e,n.templates)}catch(t){console.log(t),e.innerHTML="<option>Error retrieving templates</option>"}}async function u(){try{Object(o.clearUserSubscriptions)();let e=await fetch("/get_user_subscription_list"),t=await e.json();r.removeSpinner(document.getElementById("subscriptionsContainerSpinner")),Object(o.populateSubscriptionTable)(t),Object(o.checkEmptySubscriptions)()}catch(e){console.log(e)}}async function m(e,t,n,l,s){try{var i=document.getElementById("tableSpinner"),a=document.getElementById("tableCover");e&&(e.parentNode.disabled=!0,r.classTimer(e,"trashCan","trashCanSecondary")),a.style.display="block",i.style.display="inline-block";let n=await fetch("/delete_subscription?tok="+t),l=await n.json();if(r.hideElements(document.getElementsByClassName("unsubscribeAlert")),l.deleted)displayUnsubscribeAlert(document.getElementById("unsubscribeAlertSuccess"),l.post,l.country,l.tok,s),updateTable(s,!0);else{if(!l.restored)throw new Error(`Error updating ${l.country} (${l.post})`);displayUnsubscribeAlert(document.getElementById("resubscribeAlertSuccess"),l.post,l.country),updateTable(s,!1)}}catch(e){e&&console.log(e),displayUnsubscribeAlert(document.getElementById("unsubscribeAlertError"),n,l)}finally{e&&(e.parentNode.disabled=!1,r.classTimer(e,"trashCanSecondary","trashCan")),a.style.display="block",i.style.display="none",Object(o.checkEmptySubscriptions)(),checkPreviousAllowance99()}}function p(e,t,n,o){var l=document.getElementById("tableSpinner");return l.style.display="inline-block",e.parentNode.disabled=!0,r.classTimer(e,"downloadSubscription","downloadSubscriptionSecondary"),fetch("/download_subscription?tok="+t).then(e=>{if(200==e.status)return e.json();throw new Error("Error retrieving file")}).then(t=>{if(!t.success)throw new Error("Error retrieving file");r.clientDownloadFile(t),r.classTimer(e,"downloadSubscriptionSecondary","downloadSubscriptionSuccess","downloadSubscription",3e3)}).catch(t=>{console.log(t),r.hideElements(document.getElementsByClassName("unsubscribeAlert")),document.getElementById("downloadSubscriptionAlertError").style.display="block",document.getElementById("downloadSubscriptionErrorMsgSpan").innerText=`${o} (${n})`,r.classTimer(e,"downloadSubscriptionSecondary","downloadSubscriptionError","downloadSubscription",8e3)}).finally(()=>{e.parentNode.disabled=!1,l.style.display="none"})}function y(e,t,n,o){var l=document.getElementById("tableSpinner");return l.style.display="inline-block",e.parentNode.disabled=!0,r.classTimer(e,"email","emailSecondary"),fetch("/fire_subscription_email?tok="+t).then(e=>{if(200==e.status)return e.json();throw new Error("Error retrieving file")}).then(t=>{if(!t.success)throw new Error("Error retrieving file");r.classTimer(e,"emailSecondary","emailSuccess","email",3e3)}).catch(t=>{console.log(t),r.hideElements(document.getElementsByClassName("unsubscribeAlert")),document.getElementById("fireSubscriptionEmailAlertError").style.display="block",document.getElementById("fireSubscriptionEmailErrorMsgSpan").innerText=`${o} (${n})`,document.getElementById("fireSubscriptionEmailErrorToSpan").innerText=document.getElementById("userEmail").value,r.classTimer(e,"emailSecondary","emailError","email",8e3)}).finally(()=>{e.parentNode.disabled=!1,l.style.display="none"})}},function(e,t,n){"use strict";n.r(t),n.d(t,"pdfToCanvas",(function(){return l})),n.d(t,"clearUserSubscriptions",(function(){return s})),n.d(t,"newSubscriptionSuccess",(function(){return i})),n.d(t,"checkEmptySubscriptions",(function(){return u})),n.d(t,"populateSubscriptionTable",(function(){return m})),n.d(t,"addDownloadFromPreview",(function(){return y}));var r=n(1),o=n(0);function l(e){return new Promise((t,n)=>{pdfjsLib.getDocument(e).promise.then((function(e){e.getPage(1).then((function(e){var n=e.getViewport({scale:1}),r=document.getElementById("previewCanvas"),o=r.getContext("2d");r.height=n.height,r.width=n.width;var l={canvasContext:o,viewport:n};e.render(l),t()})).catch(e=>{console.log(e),n("Error generating preview")})}))})}function s(){let e=document.getElementById("subscriptionTbody");for(;e.firstChild;)e.removeChild(e.firstChild);document.getElementById("subscriptionsTable").style.display="none",document.getElementById("noActiveSubscriptions").style.display="none"}function i(e){o.hideElements(document.getElementsByClassName("alert")),o.hideElements([document.getElementById("subscriptionFormContainer")]),document.getElementById("successContainer").style.display="block";for(let[t,n]of Object.entries($("#postSelect option")))if(n.getAttribute("data-COLARatesId")==e)return void(document.getElementById("successSpan").innerText=n.innerText)}function a(e=!1){let t=document.getElementById("templateSelect");return document.getElementById("previousTemplateErrorMsgDownload").style.display="none",document.getElementById("previousTemplateErrorMsgPreview").style.display="none",document.getElementById("downloadTemplateSpan").classList.remove("downloadSuccess","downloadError"),0===t.selectedIndex?(t.classList.add("usa-input--error"),e?document.getElementById("previousTemplateErrorMsgDownload").style.display="block":document.getElementById("previousTemplateErrorMsgPreview").style.display="block",!1):(t.classList.remove("usa-input--error"),!0)}function d(e=!1){let t=document.getElementsByClassName("postVal"),n=document.getElementById("postSelect");if(0===n.selectedIndex){o.removeClasses(t,["val"]),o.addClasses(t,["invalBlank"]);var r=!1;e&&n.classList.add("usa-input--error")}else{o.removeClasses(t,["invalBlank"]),o.addClasses(t,["val"]),n.classList.remove("usa-input--error");r=!0}return r}function c(e=!1){let t=!1,n=document.getElementsByClassName("templateVal"),r=document.getElementById("uploadTemplate"),l=document.getElementById("templateSelect");const s=/(\.doc|\.docx)$/i;return t=d(e),r.value||0!==l.selectedIndex?s.exec(r.value)||s.exec(l[l.selectedIndex].value)?(o.removeClasses(n,["invalBlank","invalid"]),o.addClasses(n,["val"]),r.classList.remove("usa-input--error"),l.classList.remove("usa-input--error"),t=t&&!0,document.getElementById("uploadTemplateErrorMsg").style.display="none",document.getElementById("previousTemplateErrorMsg").style.display="none",document.getElementById("previousTemplateErrorMsgPreview").style.display="none",document.getElementById("previousTemplateErrorMsgDownload").style.display="none"):(o.removeClasses(n,["val","invalBlank"]),o.addClasses(n,["invalid"]),e&&(document.getElementById("infoContainer").style.display="none",document.getElementById("warningContainer").style.display="block"),r.value?r.classList.add("usa-input--error"):l.value&&l.classList.add("usa-input--error"),t=!1):(o.removeClasses(n,["val","invalid"]),o.addClasses(n,["invalBlank"]),e&&(r.classList.add("usa-input--error"),l.classList.add("usa-input--error")),t=!1),t}function u(){let e=document.getElementById("subscriptionsTable"),t=document.getElementById("subscriptionTbody"),n=document.getElementById("noActiveSubscriptions"),r=!1;t.childNodes.forEach(e=>{"none"!==e.style.display&&(r=!0)}),r?(e.style.display="table",n.style.display="none"):(e.style.display="none",n.style.display="block")}function m(e,t=null){let n=document.getElementById("subscriptionTbody");e.subscriptionList.forEach(e=>{let o=document.createElement("tr");o.setAttribute("data-subscriptionId",e.subscriptionId),o.setAttribute("class","subscriptionRow"),function(e,t){let n=document.createElement("td"),o=document.createElement("tr"),l=document.createElement("tr"),s=document.createElement("td"),i=document.createElement("td"),a=document.createElement("td"),d=document.createElement("td");n.setAttribute("class","td tdButtons");let c=document.createElement("button");c.setAttribute("class","btn-clear"),c.setAttribute("data-subscriptionId",t.subscriptionId),c.setAttribute("title",`Preview ${t.country} (${t.post}) document`),c.addEventListener("click",e=>{e.preventDefault(),r.templatePreview(null,t.tok)});let u=document.createElement("i");u.setAttribute("class","preview"),c.appendChild(u),s.appendChild(c);let m=document.createElement("button");m.setAttribute("class","btn-clear"),m.setAttribute("data-subscriptionId",t.subscriptionId),m.setAttribute("title",`Download ${t.country} (${t.post}) document`);let p=document.createElement("i");p.setAttribute("class","downloadSubscription"),m.appendChild(p),m.addEventListener("click",e=>{e.preventDefault(),r.downloadSubscription(p,t.tok,t.post,t.country)}),i.appendChild(m);let y=document.createElement("button");y.setAttribute("class","btn-clear"),y.setAttribute("data-subscriptionId",t.subscriptionId),y.setAttribute("title",`Delete ${t.country} (${t.post}) subscription`);let b=document.createElement("i");b.setAttribute("class","trashCan"),y.appendChild(b),y.addEventListener("click",e=>{e.preventDefault(),r.deleteSubscription(b,t.tok,t.post,t.country,t.subscriptionId)}),a.appendChild(y);let f=document.createElement("button");f.setAttribute("class","btn-clear"),f.setAttribute("data-subscriptionId",t.subscriptionId),f.setAttribute("title",`Send email for this subscription: ${t.country} (${t.post}) now`);let v=document.createElement("i");v.setAttribute("class","email"),f.appendChild(v),f.addEventListener("click",e=>{e.preventDefault(),r.fireSubscriptionEmail(v,t.tok,t.post,t.country)}),d.appendChild(f),n.appendChild(o),o.appendChild(s),o.appendChild(i),n.appendChild(l),l.appendChild(a),l.appendChild(d),e.appendChild(n)}(o,e);let l=document.createElement("td");l.setAttribute("class","td countryName tdCell"),l.setAttribute("data-value",e.country),l.innerText=e.country,o.appendChild(l);let s=document.createElement("td");s.setAttribute("class","td postName tdCell"),s.setAttribute("data-value",e.post),s.innerText=e.post,o.appendChild(s);let i=document.createElement("td");if(i.setAttribute("class","td prevAllowance tdCell"),i.setAttribute("data-value",e.prevAllowance),i.innerText=e.prevAllowance+"%",o.appendChild(i),-99===e.prevAllowance){i.innerText="n/a";let e=document.createElement("sup");e.innerText="*",i.appendChild(e)}let a=document.createElement("td");a.setAttribute("class","td tdCell"),a.setAttribute("data-value",e.allowance),a.innerText=e.allowance+"%",o.appendChild(a);let d=document.createElement("td");d.setAttribute("class","td tdCell"),d.setAttribute("data-value",Date.parse(new Date(e.effectiveDate))),d.innerText=e.effectiveDate,o.appendChild(d),null===t?n.appendChild(o):n.insertBefore(o,n.childNodes[t-1])}),function(){let e=document.getElementsByClassName("prevAllowance");for(let t=0;t<e.length;t++)if(e[t].innerText.match("n/a")&&"none"!==e[t].parentElement.style.display)return void(document.getElementById("prevAllowanceWarning").style.display="flow");document.getElementById("prevAllowanceWarning").style.display="none"}()}function p(e,t=null,n=null){null!==n&&(b=n);let r=function(e,t){let n,r=[];for(let o=0;o<e.length;o++)n=e[o].getElementsByClassName("tdCell")[t].getAttribute("data-value"),r.push({element:e[o],value:parseInt(n)?parseInt(n):n.toLowerCase()});return r}(e.getElementsByClassName("subscriptionRow"),b);null!==n&&null!==t&&t.classList.contains("sortedDown")?(o.insertionSort(r,!0),o.removeSortClasses(e.getElementsByClassName("thead")[0].getElementsByClassName("sortIcon")),t.classList.remove("sort"),t.classList.add("sortedUp"),f=!0):null!==n&&null!==t&&t.classList.contains("sortedUp")?(o.insertionSort(r,!1),o.removeSortClasses(e.getElementsByClassName("thead")[0].getElementsByClassName("sortIcon")),t.classList.remove("sort"),t.classList.add("sortedDown"),f=!1):null!==n&&null!==t?(o.insertionSort(r,!0),o.removeSortClasses(e.getElementsByClassName("thead")[0].getElementsByClassName("sortIcon")),t.classList.remove("sort"),t.classList.add("sortedUp"),f=!1):o.insertionSort(r,f),o.clearTableRows(e),o.displayTableRows(e,r)}function y(e,t,n,o,l){let s=document.createElement("i");s.setAttribute("id","downloadFromPreview"),s.setAttribute("class","mr-3 downloadSubscriptionLg"),console.log(t),console.log(n),s.addEventListener("click",()=>{!async function(e,t,n,o,l){e.classList.remove("downloadSubscriptionLg","downloadSubscriptionErrorLg","downloadSubscriptionSuccessLg"),e.classList.add("fa","fa-spinner","fa-spin");try{null!==t?await r.templateDownload(t):r.downloadSubscription(e,n,o,l),e.classList.add("downloadSubscriptionSuccessLg")}catch(t){console.log(t),e.classList.add("downloadSubscriptionErrorLg")}finally{e.classList.remove("fa","fa-spinner","fa-spin"),setTimeout(()=>{e.classList.remove("downloadSubscriptionSuccessLg","downloadSubscriptionErrorLg"),e.classList.add("downloadSubscriptionLg")},5e3)}}(s,t,n,o,l)}),e.insertBefore(s,e.childNodes[0])}document.addEventListener("DOMContentLoaded",async()=>{await r.fetchUserSubscriptionList();!function(){let e=document.getElementsByClassName("templateVal"),t=document.getElementById("uploadTemplate"),n=document.getElementById("templateSelect");const r=/(\.doc|\.docx)$/i;t.value&&!r.exec(t.value)?(o.removeClasses(e,["val","invalBlank"]),o.addClasses(e,["invalid"]),t.classList.add("usa-input--error"),d()):0===n.selectedIndex||r.exec(n[n.selectedIndex].value)||(o.removeClasses(e,["val","invalBlank"]),o.addClasses(e,["invalid"]),n.classList.add("usa-input--error"),d())}(),document.getElementById("subscribeAdditional").addEventListener("click",()=>{o.hideElements($(".alert")),document.getElementById("infoContainer").style.display="block",document.getElementById("subscriptionFormContainer").style.display="block"}),document.getElementById("previewPrevTemplate").addEventListener("click",e=>{e.preventDefault();let t=document.getElementById("templateSelect"),n=t[t.selectedIndex].getAttribute("data-templateId");a()&&r.templatePreview(n)}),document.getElementById("downloadPrevTemplate").addEventListener("click",(async function(e){e.preventDefault();let t=document.getElementById("templateSelect"),n=t[t.selectedIndex].getAttribute("data-templateId");a(!0)&&(this.disabled=!0,await r.templateDownload(n),this.disabled=!1)})),$("#previewTemplateModal").on("hidden.bs.modal",()=>{o.clearCanvas(document.getElementById("previewCanvas")),document.getElementById("previewTemplateLabel").innerText=""}),document.getElementById("templateSelect").addEventListener("change",e=>{document.getElementById("uploadTemplate").value="",c()}),document.getElementById("uploadTemplate").addEventListener("input",e=>{document.getElementById("templateSelect").selectedIndex=0,c()}),document.getElementById("submitNewSubscription").addEventListener("click",async e=>{e.preventDefault(),document.getElementById("submitNewSubscription").disabled=!0,o.showSpinner(document.getElementById("addNewSubscriptionButtons")),c(!0)&&await r.submitNewSubscription(),document.getElementById("submitNewSubscription").disabled=!1,o.removeSpinner(document.getElementById("addNewSubscriptionButtons"))}),document.getElementById("postSelect").addEventListener("change",c),document.getElementById("uploadTemplate").addEventListener("change",c),document.getElementById("templateSelect").addEventListener("change",c),function(){let e=document.getElementById("subscriptionsTable"),t=document.getElementsByClassName("sortIcon");Object.values(t).forEach((t,n)=>{t.addEventListener("click",()=>{p(e,t,n)})})}()});var b=0,f=!0}]);